---
title: "EDA_Candice"
author: "Candice Yu"
date: "2023-11-16"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(data.table)
```

```{r}
mortality_data <- read_csv("mortality_data.csv") %>%
  janitor::clean_names() %>%
  drop_na(outcome) %>%
  mutate(group = as.factor(group), 
         gender = as.factor(gendera),
         outcome = as.factor(outcome),
         hypertensive = as.factor(hypertensive),
         atrialfibrillation = as.factor(atrialfibrillation),
         chd_with_no_mi = as.factor(chd_with_no_mi),
         diabetes = as.factor(diabetes),
         deficiencyanemias = as.factor(deficiencyanemias),
         depression = as.factor(depression),
         hyperlipemia = as.factor(hyperlipemia),
         renal_failure = as.factor(renal_failure),
         copd = as.factor(copd))


```

```{r}
skimr::skim(mortality_data)
```
Target Variable - Outcome
* 0 - Alive
* 1 - Death


# Gender & Outcome
```{r}
mortality_data %>%
  group_by(gender) %>%
  summarise(
    count = n(), # total number of entries for each gender
    outcome_0 = sum(outcome == 0), # number of outcomes with value 0
    outcome_1 = sum(outcome == 1), # number of outcomes with value 1
    percentage = outcome_1/count
  ) %>%
  knitr::kable(digits = 3)  
```


# Age & Outcome
```{r}
# Define age intervals
age_breaks <- c(-Inf, 20, 40, 60, 80, Inf)
age_labels <- c('Under 20', '20-40', '40-60', '60-80', 'Over 80')

# Create age groups and summarize outcomes
mortality_data %>%
  mutate(age_group = cut(age, breaks = age_breaks, labels = age_labels, right = FALSE)) %>%
  group_by(age_group) %>%
  summarise(count = n(),
            outcome_0 = sum(outcome == 0, na.rm = TRUE),
            outcome_1 = sum(outcome == 1, na.rm = TRUE),
            percentage = outcome_1/(outcome_0 + outcome_1)) %>%
  knitr::kable(digits = 3)  

```

# Univariate Analysis
```{r}
# Distribution of Age
ggplot(mortality_data, aes(x = age)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black") +
  ggtitle("Age Distribution")

# Distribution of BMI (handling missing values)
ggplot(mortality_data %>% drop_na(bmi), aes(x = bmi)) +
  geom_histogram(binwidth = 1, fill = "darkgreen", color = "black") +
  ggtitle("BMI Distribution")

```

# Bivariate Analysis
```{r}

# Bivariate Analysis
ggplot(mortality_data, aes(x = gender, y = age, fill = outcome)) +
  geom_boxplot() +
  ggtitle("Age Distribution by Gender and Outcome")

```

**Age Distribution by Gender and Outcome:**
The boxplots show the age distribution for different genders and outcomes. We see that for both genders, the age distribution for patients who did not survive (outcome 1) is slightly higher. This could indicate that older age is a risk factor for mortality in this patient group.


# Exploring Outcomes
```{r}
# Age distribution by Outcome
ggplot(mortality_data, aes(x = age, fill = as.factor(outcome))) +
  geom_histogram(binwidth = 5, position = "dodge") +
  ggtitle("Age Distribution by Outcome")


# Blood Pressure by Outcome
ggplot(mortality_data, aes(x = systolic_blood_pressure, y = diastolic_blood_pressure, color = as.factor(outcome))) +
  geom_point(alpha = 0.5) +
  ggtitle("Blood Pressure by Outcome")

# BMI by Gender and Outcome
ggplot(mortality_data %>% drop_na(bmi), aes(x = bmi, fill = as.factor(outcome))) +
  geom_histogram(binwidth = 1, position = "dodge") +
  facet_wrap(~gender) +
  ggtitle("BMI by Gender and Outcome")

# Heart Rate by Outcome
ggplot(mortality_data, aes(x = heart_rate, fill = as.factor(outcome))) +
  geom_density(alpha = 0.7) +
  ggtitle("Heart Rate Distribution by Outcome")
```

**Age Distribution by Outcome:**

The histogram shows the age distribution for the two outcomes. We observe that the majority of patients are between 60 and 80 years old. There is a noticeable overlap in the age distribution of patients who survived and those who did not, suggesting that while age may be a factor, it's not the sole determinant of mortality.


**Blood Pressure by Outcome:**

This scatterplot shows systolic vs. diastolic blood pressure colored by outcome. The points are widely spread, indicating variability in blood pressure readings across the patient population. There doesn't seem to be a clear separation between the two outcomes based on blood pressure alone.


**BMI by Gender and Outcome:**

It shows a wide range of BMI values for both genders, with no clear pattern indicating that BMI is distinctly associated with the outcome. However, there are more data points for BMI for outcome 0, which may suggest a higher survival rate for patients with a lower BMI, although further statistical analysis is needed.


**Heart Rate Distribution by Outcome:**

The density plot for heart rate shows that the distribution of heart rates for patients who did not survive is slightly shifted towards the higher end compared to those who survived. This could suggest that a higher heart rate is associated with a higher risk of mortality.

